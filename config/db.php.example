<?php
session_start();

// Database configuration
$host = 'localhost';
$dbname = 'englishlab';
$username = 'root';
$password = '';

// Create connection
$conn = new mysqli($host, $username, $password, $dbname);

// Check connection
if ($conn->connect_error) {
    die("Connection failed: " . $conn->connect_error);
}

// Set charset to utf8mb4 for proper Unicode support
$conn->set_charset("utf8mb4");

// Helper functions
function sanitize($data) {
    global $conn;
    return mysqli_real_escape_string($conn, trim($data));
}

function isLoggedIn() {
    return isset($_SESSION['user']) && !empty($_SESSION['user']);
}

function isAdmin() {
    return isLoggedIn() && isset($_SESSION['user']['role']) && $_SESSION['user']['role'] === 'admin';
}

function getActivePage() {
    return basename(parse_url($_SERVER['REQUEST_URI'], PHP_URL_PATH), '.php') ?: 'index';
}

function safeImage($url) {
    if (empty($url)) {
        return 'https://source.unsplash.com/featured/?english,study';
    }
    return $url;
}

function DEFAULT_IMAGE_URL() {
    return 'https://source.unsplash.com/featured/?english,study';
}
?>

